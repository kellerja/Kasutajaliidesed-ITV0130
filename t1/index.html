<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link href="css/bootstrap/bootstrap.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">  
    <script src="scripts/popper/popper.js"></script>
    <script src="scripts/vue/vue.js"></script>
</head>
<body>
    <div id="app" class="container">
        <div class="row justify-content-center">
            <div class="col">
                <h1>Elukohateade</h1>
            </div>
        </div>
        <div class="row" v-if="tab == 1">
            <form class="submitter-info">
                <h4>{{tab}}. Esitaja</h4>
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100 form-control-label" id="submitter_firstname_label">Eesnimi</span>
                        </div>
                        <input :class="['form-control', {'is-invalid': !formData.people[0].firstName.isValid}]" 
                            v-model="formData.people[0].firstName.value" 
                            @keyup="formData.people[0].firstName.validate()" @blur="formData.people[0].firstName.validate()"
                            aria-label="Eesnimi" aria-describedby="submitter_firstname_label">
                        <small class="invalid-feedback text-right">{{ formData.people[0].firstName.errorMsg }}</small>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100" id="submitter_lastname_label">Perenimi</span>
                        </div>
                        <input :class="['form-control', {'is-invalid': !formData.people[0].lastName.isValid}]" 
                            v-model="formData.people[0].lastName.value" 
                            @keyup="formData.people[0].lastName.validate()" @blur="formData.people[0].lastName.validate()"
                            aria-label="Perenimi" aria-describedby="submitter_lastname_label" required>
                        <small class="invalid-feedback text-right">{{ formData.people[0].lastName.errorMsg }}</small>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100" id="submitter_phone_label">Telefon</span>
                        </div>
                        <input :class="['form-control', {'is-invalid': !formData.people[0].phone.isValid}]" 
                            v-model="formData.people[0].phone.value" 
                            @keyup="formData.people[0].phone.validate()" @blur="formData.people[0].phone.validate()"
                            aria-label="Telefon" aria-describedby="submitter_phone_label" required>
                        <small class="invalid-feedback text-right">{{ formData.people[0].phone.errorMsg }}</small>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100" id="submitter_email_label">Email</span>
                        </div>
                        <input :class="['form-control', {'is-invalid': !formData.people[0].email.isValid}]" 
                            v-model="formData.people[0].email.value" 
                            @keyup="formData.people[0].email.validate()" @blur="formData.people[0].email.validate()"
                            aria-label="Email" aria-describedby="submitter_email_label" required>
                        <small class="invalid-feedback text-right">{{ formData.people[0].email.errorMsg }}</small>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100" id="submitter_idcode_label">Isikukood</span>
                        </div>
                        <input :class="['form-control', {'is-invalid': !formData.people[0].idCode.isValid}]" 
                            v-model="formData.people[0].idCode.value" 
                            @keyup="formData.people[0].idCode.validate()" @blur="formData.people[0].idCode.validate()"
                            aria-label="Isikukood" aria-describedby="submitter_idcode_label" required>
                        <small class="invalid-feedback text-right">{{ formData.people[0].idCode.errorMsg }}</small>
                    </div>
                </div>
                <input type="submit" class="btn" @click.prevent="moveToTab(tab+1)" value="Järgmine">
            </form>
        </div>
        <div class="row" v-else-if="tab==2">
            <form class="new-address">
                <h4>{{tab}}. Uue elukoha aadress</h4>
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100" id="new_address_country_label">Riik</span>
                        </div>
                        <input :class="['form-control', {'is-invalid': !formData.newAddress.country.isValid}]" 
                            v-model="formData.newAddress.country.value" 
                            @keyup="formData.newAddress.country.validate()" @blur="formData.newAddress.country.validate()"
                            aria-label="Riik" aria-describedby="new_address_country_label" required>
                        <small class="invalid-feedback text-right">{{ formData.newAddress.country.errorMsg }}</small>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100" id="new_address_province_label">Maakond</span>
                        </div>
                        <input :class="['form-control', {'is-invalid': !formData.newAddress.county.isValid}]" 
                            v-model="formData.newAddress.county.value" 
                            @keyup="formData.newAddress.county.validate()" @blur="formData.newAddress.county.validate()"
                            aria-label="Maakond" aria-describedby="new_address_province_label" required>
                        <small class="invalid-feedback text-right">{{ formData.newAddress.county.errorMsg }}</small>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100" id="new_address_city_label">Vald/linn, alevik, küla</span>
                        </div>
                        <input :class="['form-control', {'is-invalid': !formData.newAddress.city.isValid}]" 
                            v-model="formData.newAddress.city.value" 
                            @keyup="formData.newAddress.city.validate()" @blur="formData.newAddress.city.validate()"
                            aria-label="Vald/linn, alevik, küla" aria-describedby="new_address_city_label" required>
                        <small class="invalid-feedback text-right">{{ formData.newAddress.city.errorMsg }}</small>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100" id="new_address_street_label">Tänav/talu, maja nr, korteri nr</span>
                        </div>
                        <input :class="['form-control', {'is-invalid': !formData.newAddress.street.isValid}]" 
                            v-model="formData.newAddress.street.value" 
                            @keyup="formData.newAddress.street.validate()" @blur="formData.newAddress.street.validate()"
                            aria-label="Tänav/talu, maja nr, korteri nr" aria-describedby="new_address_street_label" required>
                        <small class="invalid-feedback text-right">{{ formData.newAddress.street.errorMsg }}</small>
                    </div>
                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100" id="new_address_postal_index_label">Postiindex</span>
                        </div>
                        <input :class="['form-control', {'is-invalid': !formData.newAddress.postalIndex.isValid}]" 
                            v-model="formData.newAddress.postalIndex.value" 
                            @keyup="formData.newAddress.postalIndex.validate()" @blur="formData.newAddress.postalIndex.validate()"
                            aria-label="Postiindex" aria-describedby="new_address_postal_index_label" required>
                        <small class="invalid-feedback text-right">{{ formData.newAddress.postalIndex.errorMsg }}</small>
                    </div>
                </div>
                <div class="form-group">
                    <label for="new_address_ownership">Ruumi kasutamisõigus</label>
                    <select class="form-control" id="new_address_ownership" v-model="formData.newAddress.ownership.value">
                        <option value="0">Olen ruumi (kaas)omanik</option>
                        <option value="1">Lisan üürilepingu</option>
                        <option value="2">Ruumi omanik annab ise elukohateatele nõusoleku</option> <!-- Kas see vajalik? Kuidas implementeerida? -->
                        <option value="3">Lisan ruumi omaniku nõusoleku eraldi paberil</option>
                        <option value="4">Ruumi kasutamise muu alus</option>
                    </select>
                </div>
                <div class="form-group" v-if="formData.newAddress.ownership.value == '1' || formData.newAddress.ownership.value == '3'">
                    <label for="new_address_ownership_proof">Lisa {{formData.newAddress.ownership.value == '1' ? 'üürileping' : 'ruumi omaniku nõusolek'}}</label>
                    <input type="file" class="form-control-file" id="new_address_ownership_proof" multiple>
                </div>
                <input type="submit" class="btn" @click.prevent="moveToTab(tab-1)" value="Eelmine">
                <input type="submit" class="btn" @click.prevent="moveToTab(tab+1)" value="Järgmine">
            </form>
        </div>
        <div class="row" v-else-if="tab == 3">
            <form class="personal-info">
                <h4>{{tab}}. Isikud, kelle elukoha aadressi muudetakse</h4>
                <div class="form-check">
                    <input type="checkbox" class="form-check-input" id="new_address_self_registration_checkbox">
                    <label class="form-check-label" for="new_address_self_registration_checkbox">Esitan uue elukoha ka enda kohta</label>                    
                </div>
                <div class="d-flex flex-wrap">
                    <div class="person" v-for="(person, index) in formData.people.slice(1)">
                        <div class="d-flex">
                            <h4>Registreeritav isik # {{index + 1}}</h4>
                            <button type="button" class="btn" tabindex="-1" @click.prevent="removePerson(index + 1)">Del</button>
                        </div>
                        <div class="form-group">
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text w-100" :id="index + '_firstname_label'">Eesnimi</span>
                                </div>
                                <input :class="['form-control', {'is-invalid': !person.firstName.isValid}]"
                                    v-model="person.firstName.value" 
                                    @keyup="person.firstName.validate()" @blur="person.firstName.validate()"
                                    aria-label="Eesnimi" :aria-describedby="index + '_firstname_label'">
                                <small class="invalid-feedback text-right">{{ person.firstName.errorMsg }}</small>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text w-100" :id="index + '_lastname_label'">Perenimi</span>
                                </div>
                                <input :class="['form-control', {'is-invalid': !person.lastName.isValid}]"
                                    v-model="person.lastName.value" 
                                    @keyup="person.lastName.validate()" @blur="person.lastName.validate()"
                                    aria-label="Perenimi" :aria-describedby="index + '_lastname_label'" required>
                                <small class="invalid-feedback text-right">{{ person.lastName.errorMsg }}</small>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text w-100" :id="index + '_phone_label'">Telefon</span>
                                </div>
                                <input :class="['form-control', {'is-invalid': !person.phone.isValid}]"
                                    v-model="person.phone.value" 
                                    @keyup="person.phone.validate()" @blur="person.phone.validate()"
                                    aria-label="Telefon" :aria-describedby="index + '_phone_label'" required>
                                <small class="invalid-feedback text-right">{{ person.phone.errorMsg }}</small>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text w-100" :id="index + '_email_label'">Email</span>
                                </div>
                                <input :class="['form-control', {'is-invalid': !person.email.isValid}]"
                                    v-model="person.email.value" 
                                    @keyup="person.email.validate()" @blur="person.email.validate()"
                                    aria-label="Email" :aria-describedby="index + '_email_label'" required>
                                <small class="invalid-feedback text-right">{{ person.email.errorMsg }}</small>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text w-100" :id="index + '_idcode_label'">Isikukood</span>
                                </div>
                                <input :class="['form-control', {'is-invalid': !person.idCode.isValid}]"
                                    v-model="person.idCode.value" 
                                    @keyup="person.idCode.validate()" @blur="person.idCode.validate()"
                                    aria-label="Isikukood" :aria-describedby="index + '_idcode_label'" required>
                                <small class="invalid-feedback text-right">{{ person.idCode.errorMsg }}</small>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <button type="button" class="btn" @click.prevent="addPerson()">Lisa isik</button>
                </div>
                <input type="submit" class="btn" @click.prevent="moveToTab(tab-1)" value="Eelmine">
                <input type="submit" class="btn" @click.prevent="moveToTab(tab+1)" value="Järgmine">
            </form>
        </div>
        <div class="row" v-else-if="tab == 4">
            <form class="extra-info">
                <h4>{{tab}}. Lisainformatsioon</h4>
                <div v-for="(person, index) in formData.people">
                    <div class="form-group">
                        <p>Kas eelmine elukoht oli välismaal?</p>
                        <!-- Rounded switch: https://www.w3schools.com/howto/howto_css_switch.asp -->
                        <label class="switch">
                            <input type="checkbox" value="true" v-model="extraDataForeignCountry">
                            <span class="slider round"></span>
                        </label>
                        <div v-if="extraDataForeignCountry">
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text w-100" :id="index + '_extra_info_prev_address_label'">Eelmine elukoht välismaal</span>
                                </div>
                                <input :class="['form-control', {'is-invalid': !person.extra.foreignCountry.isValid}]"
                                    v-model="person.extra.foreignCountry.value" 
                                    @keyup="person.extra.foreignCountry.validate()" @blur="person.extra.foreignCountry.validate()"
                                    aria-label="Eelmine elukoht välismaal" 
                                    :aria-describedby="index + '_extra_info_prev_address_label'">
                                <small class="invalid-feedback text-right">{{ person.extra.foreignCountry.errorMsg }}</small>
                            </div>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text w-100" :id="index + '_extra_info_departed_time_label'">Eestist lahkumise aeg</span>
                                </div>
                                <input :class="['form-control', {'is-invalid': !person.extra.leftEstoniaTime.isValid}]"
                                    v-model="person.extra.leftEstoniaTime.value" 
                                    @keyup="person.extra.leftEstoniaTime.validate()" @blur="person.extra.leftEstoniaTime.validate()"
                                    aria-label="Eelmine elukoht välismaal" 
                                    aria-label="Eestist lahkumise aeg" 
                                    :aria-describedby="index + '_extra_info_departed_time_label'">
                                <small class="invalid-feedback text-right">{{ person.extra.leftEstoniaTime.errorMsg }}</small>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <p>Kas sul on välisriigi isikukood?</p> <!-- Kas saab olla mitu isikukoodi? -->
                        <!-- Rounded switch: https://www.w3schools.com/howto/howto_css_switch.asp -->
                        <label class="switch">
                            <input type="checkbox" value="true" v-model="extraDataForeignIdCode">
                            <span class="slider round"></span>
                        </label>
                        <div v-if="extraDataForeignIdCode">
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text w-100" :id="index + '_extra_info_foreign_id_country_label'">Isikukoodi väljastanud riik</span>
                                </div>
                                <input aria-label="Isikukoodi väljastanud riik" :aria-describedby="index + '_extra_info_foreign_id_country_label'">
                            </div>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text w-100" :id="index + '_extra_info_foreign_id_label'">Välisriigi isikukood</span>
                                </div>
                                <input aria-label="Välisriigi isikukood" :aria-describedby="index + '_extra_info_foreign_id_label'">
                            </div>
                        </div>
                    </div>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100" :id="index + '_extra_info_nationality_label'">Rahvus*</span>
                        </div>
                        <input aria-label="Rahvus" :aria-describedby="index + '_extra_info_nationality_label'">
                    </div>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text w-100" :id="index + '_extra_info_mother_tongue_label'">Emakeel*</span>
                        </div>
                        <input aria-label="Emakeel" :aria-describedby="index + '_extra_info_mother_tongue_label'">
                    </div>
                    <div class="form-group">
                        <label :for="index + '_extra_info_education'">Omandatud kõrgeim haridustase*</label>
                        <select class="form-control" :id="index + '_extra_info_education'">
                            <option value="-">Ei soovi avaldada</option>
                            <option value="0">Alusharidus (koolieelne haridus) või alghariduseta</option>
                            <option value="1">Põhiharidus (põhikooli 1.-6. klass), varasem algharidus</option>
                            <option value="2">Põhiharidus (põhikooli 8.-9. klass)</option>
                            <option value="35">Kutseharidus või kutseõpe (sh keskeri- või tehnikumiharidus) põhihariduse baasil</option>
                            <option value="3">Keskharidus</option>
                            <option value="4">Kutseharidus või kutseõpe keskhariduse baasil</option>
                            <option value="5">Keskeri- ja tehnikumiharidus keskhariduse baasil</option>
                            <option value="6">Bakalaureus või sellega võrdsustatud haridus (rakendus- ja kutsekõrgharidus, diplomiõpe)</option>
                            <option value="7">Magister või sellega võrdsustatud haridus</option>
                            <option value="8">Doktor või sellega võrdsustatud haridus</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label :for="index + '_extra_info_employment'">Sotsiaal-majanduslik seisund*</label>
                        <select class="form-control" :id="index + '_extra_info_employment'">
                            <option value="-">Ei soovi avaldada</option>
                            <option value="A">töötav</option>
                            <option value="B">kodune</option>
                            <option value="C">töötu/tööd otsiv</option>
                            <option value="D">ajateenija</option>
                            <option value="E">(üli)õpilane</option>
                            <option value="F">pensionär</option>
                            <option value="G">lapsehoolduspuhkusel</option>
                            <option value="H">muu mittetöötav</option>
                        </select>
                    </div>
                </div>
                <input type="submit" @click.prevent="moveToTab(tab-1)" value="Eelmine">
                <input type="submit" @click.prevent="" value="Saada">
            </form>
        </div>
    </div>
    <script src="scripts/main.js"></script>
</body>
</html>
