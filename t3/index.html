<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
    <title>Kodutöö hindamine</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic|Material+Icons">
    <link rel="stylesheet" href="css/vue-material.min.css">
    <link rel="stylesheet" href="css/theme/default.css">
    <link href="css/main.css" rel="stylesheet">  
    <script src="scripts/vue/vue.js"></script>
    <script src="scripts/vue-material.min.js"></script>
</head>
<body style="overflow-x:hidden">
    <div id="app" class="md-layout md-gutter">

        <md-toolbar style="z-index: 4; min-height: 4rem">
            <h3 class="md-title" style="margin-left: 25%">Kodutöö 2 hindamine</h3>
        </md-toolbar>
            
        <div class="md-layout-item">
            <md-drawer style="position: fixed;" md-permanent="full" :md-active.sync="showMenu" md-fixed>
                <div style="margin-top: 5rem; margin-left: 1rem">
                    <div class="md-layout">
                        <span class="md-layout-item">Ülesande baas tähtaeg:</span>
                        <span class="md-layout-item">{{new Date(deadline).toLocaleString()}}</span>
                    </div>
                    <md-divider></md-divider>
                    <div class="md-layout" v-if="isProjectSelected">
                        <span class="md-layout-item">Tudengid:</span>
                        <span class="md-layout-item">{{group.studentStrings.reduce((acc, curr) => acc + (!acc ? '' : ', ') + curr, '')}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected">
                        <span class="md-layout-item">Projektile antud pikendust:</span>
                        <span class="md-layout-item">{{group.project.deadlineExtensionCount}} {{group.project.deadlineExtensionCount === 1 ? 'nädal' : 'nädalat'}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected && group.project.deadlineExtensionCount > 0">
                        <span class="md-layout-item">Projekti tähtaeg pikendusega:</span>
                        <span class="md-layout-item">{{new Date(group.project.getExtendedDeadline()).toLocaleString()}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected && group.project.deadlineExtensionCount > 0"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected && group.project.getTimeRemaining() >= 0">
                        <span class="md-layout-item">Aega jäänud:</span>
                        <span class="md-layout-item">{{getTimeString(group.project.getTimeRemaining(), {seconds:true})}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected && group.project.getTimeRemaining() >= 0"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected && group.project.getTimeRemaining() < 0">
                        <span class="md-layout-item">Hilinenud:</span>
                        <span class="md-layout-item">{{getTimeString(-group.project.getTimeRemaining(), {seconds:true})}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected && group.project.getTimeRemaining() < 0"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected && group.project.getTimeRemaining() < 0">
                        <span class="md-layout-item">Hilinemise eest miinuseid:</span>
                        <span class="md-layout-item">{{Project.getDelayScore(-group.project.getTimeRemaining())}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected && group.project.getTimeRemaining() < 0"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected">
                        <span class="md-layout-item">Skoor:</span>
                        <span class="md-layout-item">{{group.project.getScore() + '/' + (group.project.base.maximumScore + group.project.extra.maximumScore)}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected">
                        <span class="md-layout-item">Baasosa:</span>
                        <span class="md-layout-item">{{group.project.base.getScore() + '/' + group.project.base.maximumScore}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected">
                        <span class="md-layout-item">Lisaosa:</span>
                        <span class="md-layout-item">{{group.project.extra.getScore() + '/' + group.project.extra.maximumScore}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected">
                        <span class="md-layout-item">Boonuseid:</span>
                        <span class="md-layout-item">{{group.project.bonus.getScore()}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected">
                        <span class="md-layout-item">Miinuseid:</span>
                        <span class="md-layout-item">{{group.project.negative.getScore()}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected">
                        <span class="md-layout-item">Miinimum ületatud?</span>
                        <span class="md-layout-item">{{group.project.getScore() >= minimumPassingScore ? 'jah' : 'ei'}}</span>
                    </div>
                    <md-divider v-if="isProjectSelected"></md-divider>
                    <div class="md-layout" v-if="isProjectSelected">
                        <span class="md-layout-item">Plagiaat?</span>
                        <span class="md-layout-item">{{group.project.plagiarism.isPlagiarized ? 'jah' : 'ei'}}</span>
                    </div>
                </div>
            </md-drawer>
        </div>

        <div class="md-layout-item md-size-80">
            <md-button @click="showMenu = !showMenu" 
                    class="md-fab md-fixed md-fab-top-left"
                    style="z-index: 99; position: fixed; top: 0; left: 1rem;" tabindex="-1" v-if="isSmallScreen">
                <md-icon>menu</md-icon>
            </md-button>
            <form class="md-layout md-alignment-top-left" @submit.prevent="">
                <md-card class="md-layout-item md-size-60 md-small-size-100" style="overflow-x:hidden; margin-bottom: 4rem;">
                    <md-card-header>
                            <div class="md-title">Meeskond</div>
                    </md-card-header>
                    <md-card-content>
                        <md-chips id="team" class="md-primary" v-model="group.studentStrings"
                                @md-insert="group.addStudent" @md-delete="group.removeStudent" @md-click="group.setLeader"
                                md-placeholder="Lisa tudengid..." md-check-duplicated>
                            <template slot="md-chip" slot-scope="{ chip }">
                                <span>{{group.students[chip].username}}</span>
                            </template>
                            <div class="md-helper-text"></div>
                        </md-chips>
                        <md-field md-clearable>
                            <label for="project_url">Projekti URL</label>
                            <md-input id="project_url" type="url" @change="group.project.url.update" v-model="group.project.url.url"></md-input>
                            <md-button @click="group.project.url.open" class="md-icon-button md-dense" tabindex="-1" v-if="group.project.url.firstTouch && group.project.url.url">
                                    <md-icon>open_in_new</md-icon>
                                </md-button>
                            <md-button @click="group.project.url.toggleUrl" class="md-icon-button md-dense" style="margin-right: 2.2rem;" tabindex="-1" v-if="group.project.url.firstTouch">
                                <md-icon v-if="group.project.url.url === group.project.url.dijkstraUrl">undo</md-icon>
                                <md-icon v-else>redo</md-icon>
                            </md-button>
                        </md-field>
                    </md-card-content>

                    <md-divider></md-divider>
                    <md-card-header>
                        <div class="md-title">Baasosa hindamine ({{group.project.base.getScore()}}/{{group.project.base.maximumScore}})</div>
                    </md-card-header>
                    <md-card-content>
                        <div class="md-layout md-gutter md-alignment-center-center" v-for="baseScore in group.project.base.elements" :key="baseScore.shortName">
                            <div class="md-layout-item md-size-5 md-xsmall-size-10">
                                <md-icon>
                                    info
                                    <md-tooltip md-direction="bottom">{{baseScore.description}}</md-tooltip>
                                </md-icon>
                            </div>
                            <div class="md-layout-item md-size-20 md-xsmall-size-90">
                                <p>{{baseScore.shortName}}</p>
                            </div>
                            <div class="md-layout-item md-xsmall-size-100">
                                <md-field>
                                    <label>Hinne</label>
                                    <md-input onclick="this.select()" v-model="baseScore.score" type="number"></md-input>
                                </md-field>
                            </div>
                            <div class="md-layout-item md-xsmall-size-100">
                                <md-field>
                                    <label>Kommentaar</label>
                                    <md-input v-model="baseScore.reason" type="text"></md-input>
                                </md-field>
                            </div>
                        </div>
                    </md-card-content>

                    <md-divider></md-divider>
                    <md-card-header>
                        <div class="md-title">Lisaosa hindamine ({{group.project.extra.getScore()}}/{{group.project.extra.maximumScore}})</div>
                    </md-card-header>
                    <md-card-content>
                        <div class="md-layout md-gutter md-alignment-center-center" v-for="extraScore in group.project.extra.elements" :key="extraScore.shortName">
                            <div class="md-layout-item md-size-5 md-xsmall-size-10">
                                <md-icon>
                                    info
                                    <md-tooltip md-direction="bottom">{{extraScore.description}}</md-tooltip>
                                </md-icon>
                            </div>
                            <div class="md-layout-item md-size-20 md-xsmall-size-90">
                                <p>{{extraScore.shortName}}</p>
                            </div>
                            <div class="md-layout-item md-xsmall-size-100">
                                <md-field>
                                    <label>Hinne</label>
                                    <md-input onclick="this.select()" v-model="extraScore.score" type="number"></md-input>
                                </md-field>
                            </div>
                            <div class="md-layout-item md-xsmall-size-100">
                                <md-field>
                                    <label>Kommentaar</label>
                                    <md-input v-model="extraScore.reason" type="text"></md-input>
                                </md-field>
                            </div>
                        </div>
                    </md-card-content>

                    <md-divider></md-divider>
                    <md-card-header>
                        <div class="md-title">Boonuspunktid ({{group.project.bonus.getScore()}})</div>
                    </md-card-header>
                    <md-card-content>
                        <div class="md-layout md-gutter md-alignment-center-center" v-for="(bonusScore, bonusIdx) in group.project.bonus.elements" :key="'bonusScore_' + bonusIdx">
                            <div class="md-layout-item md-medium-size-10 md-xsmall-size-15 md-size-5">
                                <md-button @click="group.project.bonus.removeBonus(bonusIdx)" class="md-icon-button md-dense md-raised md-accent" tabindex="-1">
                                    <md-icon>remove</md-icon>
                                </md-button>
                            </div>
                            <div class="md-layout-item md-xsmall-size-85">
                                <md-field>
                                    <label>Boonus</label>
                                    <md-input onclick="this.select()" v-model="bonusScore.score" type="number"></md-input>
                                </md-field>
                            </div>
                            <div class="md-layout-item md-xsmall-size-100">
                                <md-field>
                                    <label>Põhjendus</label>
                                    <md-input v-model="bonusScore.reason" type="text"></md-input>
                                </md-field>
                            </div>
                        </div>
                        <md-button @click="group.project.bonus.addBonus()" class="md-icon-button md-raised md-accent" tabindex="-1">
                            <md-icon>add</md-icon>
                        </md-button>
                    </md-card-content>

                    <md-divider></md-divider>
                    <md-card-header>
                        <div class="md-title">Miinuspunktid ({{group.project.negative.getScore()}})</div>
                    </md-card-header>
                    <md-card-content>
                        <div class="md-layout md-gutter md-alignment-center-center" v-for="(minusScore, minusIdx) in group.project.negative.elements" :key="'minusScore' + minusIdx">
                            <div class="md-layout-item md-medium-size-10 md-xsmall-size-15 md-size-5">
                                <md-button @click="group.project.negative.removeNegative(minusIdx)" class="md-icon-button md-dense md-raised md-accent" tabindex="-1">
                                    <md-icon>remove</md-icon>
                                </md-button>
                            </div>
                            <div class="md-layout-item md-xsmall-size-85">
                                <md-field>
                                    <label>Miinus</label>
                                    <md-input onclick="this.select()" v-model="minusScore.score" type="number"></md-input>
                                </md-field>
                            </div>
                            <div class="md-layout-item md-xsmall-size-100">
                                <md-field>
                                    <label>Põhjendus</label>
                                    <md-input v-model="minusScore.reason" type="text"></md-input>
                                </md-field>
                            </div>
                        </div>
                        <md-button @click="group.project.negative.addNegative()" class="md-icon-button md-raised md-accent" tabindex="-1">
                            <md-icon>add</md-icon>
                        </md-button>
                    </md-card-content>

                    <md-divider></md-divider>
                    <md-card-header>
                        <div class="md-title">Tulemus</div>
                    </md-card-header>
                    <md-card-header>
                        <div class="md-subheader">Skoor</div>
                    </md-card-header>
                    <md-card-content class="md-layout">
                        <div class="md-layout-item">Baasosa</div>
                        <div class="md-layout-item">{{group.project.base.getScore() + '/' + group.project.base.maximumScore}}</div>                        
                    </md-card-content>
                    <md-card-content class="md-layout">
                        <div class="md-layout-item">Lisaosa</div>
                        <div class="md-layout-item">{{group.project.extra.getScore() + '/' + group.project.extra.maximumScore}}</div>                        
                    </md-card-content>
                    <md-card-content class="md-layout">
                        <div class="md-layout-item">Boonuseid</div>
                        <div class="md-layout-item">{{group.project.bonus.getScore()}}</div>                        
                    </md-card-content>
                    <md-card-content class="md-layout">
                        <div class="md-layout-item">Miinuseid</div>
                        <div class="md-layout-item">{{group.project.negative.getScore()}}</div>                        
                    </md-card-content>
                    <md-card-content class="md-layout">
                        <div class="md-layout-item">Hilinemise eest miinuseid</div>
                        <div class="md-layout-item">{{Project.getDelayScore(-group.project.getTimeRemaining())}}</div>                        
                    </md-card-content>
                    <md-card-content class="md-layout">
                        <div class="md-layout-item">Kokku</div>
                        <div class="md-layout-item">{{group.project.getScore() + '/' + (group.project.base.maximumScore + group.project.extra.maximumScore)}}</div>                        
                    </md-card-content>

                    <md-card-header>
                        <div class="md-subheader">Tähtaeg</div>
                    </md-card-header>
                    <md-card-content class="md-layout">
                        <div class="md-layout-item">Ülesande tähtaeg</div>
                        <div class="md-layout-item">{{new Date(deadline).toLocaleString()}}</div>                        
                    </md-card-content>
                    <md-card-content class="md-layout md-alignment-center-center">
                        <div class="md-layout-item">Pikendust antud</div>
                        <div class="md-layout-item" style="align-content: center">
                            <md-button @click="group.project.decrementDeadline()" class="md-icon-button md-dense md-raised">
                                <md-icon>remove</md-icon>
                            </md-button>
                            <span style="display: inline-block; margin-top: 0.35rem">{{group.project.deadlineExtensionCount}} {{group.project.deadlineExtensionCount === 1 ? 'nädal' : 'nädalat'}}</span>
                            <md-button @click="group.project.incrementDeadline()" class="md-icon-button md-dense md-raised">
                                <md-icon>add</md-icon>
                            </md-button>
                        </div>
                    </md-card-content>
                    <md-card-content class="md-layout">
                        <div class="md-layout-item">Ülesande tähtaeg pikendusega</div>
                        <div class="md-layout-item">{{new Date(group.project.getExtendedDeadline()).toLocaleString()}}</div>                        
                    </md-card-content>
                    <md-card-content class="md-layout" v-if="group.project.getTimeRemaining() >= 0">
                        <div class="md-layout-item">Aega jäänud</div>
                        <div class="md-layout-item">{{getTimeString(group.project.getTimeRemaining(), {seconds: true})}}</div>                        
                    </md-card-content>
                    <md-card-content class="md-layout" v-else>
                        <div class="md-layout-item">Hilinenud</div>
                        <div class="md-layout-item">{{getTimeString(-group.project.getTimeRemaining(), {seconds: true})}}</div>                        
                    </md-card-content>

                    <md-card-header>
                        <div class="md-subheader">Plagiaat</div>
                    </md-card-header>
                    <md-card-content class="md-layout">
                        <div class="md-layout-item">Plagiaat</div>
                        <div class="md-layout-item">
                            <div class="md-layout">
                                <div class="md-layout-item">{{group.project.plagiarism.isPlagiarized ? 'jah' : 'ei'}}</div>
                                <div class="md-layout-item">
                                    <md-button class="md-raised md-accent" @click="group.project.plagiarism.togglePlagiarism()">
                                        {{group.project.plagiarism.isPlagiarized ? 'Märgi originaalina' : 'Märgi plagiaadina'}}
                                    </md-button>
                                </div>
                            </div>
                        </div>
                    </md-card-content>
                    <md-card-content class="md-layout" v-if="group.project.plagiarism.isPlagiarized">
                        <div class="md-layout-item"></div>
                        <div class="md-layout-item">
                            <md-field>
                                <label>Põhjendus</label>
                                <md-textarea md-autogrow v-model="group.project.plagiarism.reason"></md-textarea>
                            </md-field>
                        </div>
                    </md-card-content> 
                    <md-card-actions>
                        <md-button class="md-raised md-accent" style="margin: 0 auto" type="submit">Lõpeta hindamine</md-button>
                    </md-card-actions>   
                </md-card>
            </form>
        </div>
    </div>
    <script src="scripts/main.js"></script>
</body>
</html>
